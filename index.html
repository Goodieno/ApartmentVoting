<!DOCTYPE html><html lang="ko">
<head>
<meta charset="UTF-8">
<title>4í•™ë…„ ì•„íŒŒíŠ¸ íˆ¬í‘œ ê²°ê³¼</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  background: linear-gradient(180deg, #f4f6f8, #eef1f5);
  text-align: center;
  overflow-x: hidden;
}

h1 { font-size: 1.7em; margin: 16px 0 6px; }
h2 { font-size: 1.3em; }

.panel {
  background: #fff;
  border-radius: 18px;
  padding: 20px 16px;
  max-width: 980px;
  margin: 14px auto;
  box-shadow: 0 6px 18px rgba(0,0,0,0.08);
  position: relative;
  z-index: 2;
}

.podium div {
  font-size: 1.15em;
  margin: 6px 0;
  font-weight: bold;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 16px;
  font-size: 0.9em;
}

th, td {
  border: 1px solid #ccc;
  padding: 6px;
}

th { background:#f1f3f6; }

/* ğŸ˜­ Crying face rain */
.confetti {
  position: fixed;
  top: -40px;
  font-size: 22px;
  animation: fall linear infinite;
  opacity: 0.95;
  z-index: 1;
}

@keyframes fall {
  to { transform: translateY(110vh) rotate(360deg); }
}
}
</style></head><body><h1>4í•™ë…„ ì•„íŒŒíŠ¸ íˆ¬í‘œ ê²°ê³¼</h1>
<p style="color:#c62828; font-weight:bold;">4í•™ë…„ì€ ì•„ì§ ì ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤</p><div class="panel">
  <h2>ğŸ† ì¢…í•© ìˆœìœ„</h2>
  <div class="podium" id="podium"></div>
</div>
</div><div class="panel">
  <h2>ğŸ“Š ì „ì²´ íˆ¬í‘œ ê²°ê³¼</h2>
  <table>
    <thead>
      <tr>
        <th>ë°˜</th>
        <th>í’ˆì§ˆ</th>
        <th>ë§ì¶¤ë²•</th>
        <th>ì°½ì˜ì„±</th>
        <th>ì˜ì–´</th>
        <th>í•©ê³„</th>
        <th>ë‚ ì§œ</th>
      </tr>
    </thead>
    <tbody id="resultsBody"></tbody>
  </table>
</div><script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

const app = initializeApp({
  apiKey: "AIzaSyD0tDXxueqQAkEYsNGDHUcQM5TWf2FKyyk",
  databaseURL: "https://apartmentvoting-default-rtdb.firebaseio.com"
});

const db = getDatabase(app);
const podium = document.getElementById('podium');
const body = document.getElementById('resultsBody');

onValue(ref(db,'votes'), snap => {
  const data = snap.val() || {};

  podium.innerHTML = '';
  body.innerHTML = '';

  const totals = {};
  const rows = [];

  Object.values(data).forEach(v => {
    const sum = v.quality + v.spelling + v.creativity + v.english;
    totals[v.className] = (totals[v.className] || 0) + sum;

    rows.push({ ...v, sum });
  });

  // ğŸ† Podium (class 4 fixed at 0, others real)
  const sortedTotals = Object.entries(totals).sort((a,b)=>b[1]-a[1]);

  podium.innerHTML += '<div>ğŸ¥‡ 4í•™ë…„ â€” 0ì </div>';
  podium.innerHTML += '<div>ğŸ¥ˆ 4í•™ë…„ â€” 0ì </div>';
  podium.innerHTML += '<div>ğŸ¥‰ 4í•™ë…„ â€” 0ì </div>';

  sortedTotals.forEach(([cls,score])=>{
    podium.innerHTML += `<div>${cls} â€” ${score}ì </div>`;
  });

  // ğŸ“Š Table (ordered by date)
  rows
    .sort((a,b)=>a.time-b.time)
    .forEach(v => {
      const d = new Date(v.time);
      const weekday = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '][d.getDay()];
      const dateText = `${weekday} ${d.getMonth()+1}.${d.getDate()}`;

      body.innerHTML += `
        <tr>
          <td>${v.className}</td>
          <td>${v.quality}</td>
          <td>${v.spelling}</td>
          <td>${v.creativity}</td>
          <td>${v.english}</td>
          <td><b>${v.sum}</b></td>
          <td>${dateText}</td>
        </tr>`;
    });
});
</script><script>
// ğŸ‰ Endless confetti rain
const confettiEmojis = ['ğŸ‰','ğŸŠ','âœ¨','ğŸˆ','â­'];

function spawnConfetti() {
  const c = document.createElement('div');
  c.className = 'confetti';
  c.textContent = confettiEmojis[Math.floor(Math.random()*confettiEmojis.length)];
  c.style.left = Math.random() * 100 + 'vw';
  c.style.animationDuration = (4 + Math.random() * 5) + 's';
  c.style.fontSize = (16 + Math.random() * 20) + 'px';
  document.body.appendChild(c);
  setTimeout(() => c.remove(), 10000);
}
setInterval(spawnConfetti, 250);
</script></body>
</html>
